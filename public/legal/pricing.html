<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - FAA.ZONE‚Ñ¢</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 from ecosystem.html */
        }
        .featured-button {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: none;
        }
        .featured-button:hover {
            box-shadow: 0 8px 25px rgba(79, 70, 229, 0.4);
        }
        .featured-button:active {
            transform: scale(0.98);
        }
        .featured-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300%;
            height: 300%;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            transition: all 0.7s ease-out;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
        }
        .featured-button:hover::before {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }
        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s, color 0.2s;
            font-weight: 500;
            color: #475569; /* slate-600 */
            text-decoration: none;
        }
        .nav-link:hover {
            background-color: #e2e8f0; /* slate-200 */
            color: #1e293b; /* slate-900 */
        }
        pre {
            background-color: #edf2f7; /* Tailwind gray-100 */
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.5;
            color: #2d3748; /* gray-800 */
            position: relative;
            margin-bottom: 1rem;
        }
        code {
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
        }
        .copy-button {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            padding: 0.3rem 0.6rem;
            background-color: #cbd5e0; /* gray-300 */
            color: #4a5568; /* gray-700 */
            border-radius: 0.375rem; /* rounded-md */
            font-size: 0.75rem; /* text-xs */
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
            z-index: 10; /* Ensure button is above pre content */
        }
        pre:hover .copy-button, .copy-button.active {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col items-center p-4">
    <div class="bg-white p-8 rounded-3xl shadow-2xl max-w-4xl w-full text-center border-t-8 border-indigo-600 animate-fade-in-down flex flex-col justify-between min-h-[80vh]">
        <div>
            <!-- FAA.ZONE‚Ñ¢ Logo/Header -->
            <div class="flex items-center justify-center gap-3 mb-8">
                <span class="text-4xl">ü¶ç</span>
                <h1 class="font-bold text-3xl text-slate-800">FAA.ZONE&trade;</h1>
            </div>

            <h2 class="text-4xl font-extrabold text-slate-800 mb-4 tracking-tight">
                Explore Our <span class="text-indigo-600">Products</span>
            </h2>
            <p class="text-lg text-slate-700 mb-8 leading-relaxed">
                Choose the package that best fits your needs and proceed to a secure checkout.
            </p>

            <!-- Currency Selector -->
            <div class="mt-8 mb-10 bg-slate-50 p-6 rounded-xl shadow-md border border-slate-200 text-left flex items-center justify-between mx-auto max-w-xs">
                <label for="currency-select" class="text-slate-700 font-medium">Display prices in:</label>
                <select id="currency-select" class="ml-4 p-2 border border-slate-300 rounded-md bg-white text-slate-800">
                    <option value="ZAR">ZAR (R)</option>
                    <option value="USD">USD ($)</option>
                    <option value="EUR">EUR (‚Ç¨)</option>
                    <option value="GBP">GBP (¬£)</option>
                </select>
            </div>

            <!-- Product Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-8">
                <!-- Product 1: Starter Package -->
                <div class="bg-slate-50 p-6 rounded-xl shadow-md border border-slate-200 text-left flex flex-col justify-between">
                    <div>
                        <h3 class="text-2xl font-bold text-slate-800 mb-2">Starter Package</h3>
                        <p class="text-slate-600 mb-4">Ideal for individuals and small teams beginning their digital journey.</p>
                        <ul class="list-disc list-inside text-slate-700 text-sm space-y-1 mb-6">
                            <li>Basic API Access</li>
                            <li>Standard Analytics Dashboard</li>
                            <li>Community Support</li>
                            <li>Up to 5 Users</li>
                        </ul>
                        <p class="text-3xl font-extrabold text-indigo-600 mb-6 price-display" data-original-price="199.00" data-currency-symbol="R" data-currency-code="ZAR">R 199.00 <span class="text-slate-500 text-base font-normal">/ month</span></p>
                    </div>
                    <button class="buy-now-button featured-button w-full bg-indigo-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-300 ease-in-out transform hover:scale-105"
                            data-product-name="Starter Package"
                            data-amount="199.00"
                            data-billing-cycle="MONTHLY"
                            data-plan-key="Starter Package_MONTHLY"
                            onclick="initiatePayPalSubscription(event)">
                        Subscribe Now (Monthly)
                    </button>
                </div>

                <!-- Product 2: Business Package -->
                <div class="bg-slate-50 p-6 rounded-xl shadow-md border border-slate-200 text-left flex flex-col justify-between">
                    <div>
                        <h3 class="text-2xl font-bold text-slate-800 mb-2">Business Package</h3>
                        <p class="text-slate-600 mb-4">Comprehensive tools for growing businesses and advanced operations.</p>
                        <ul class="list-disc list-inside text-slate-700 text-sm space-y-1 mb-6">
                            <li>Advanced API Access</li>
                            <li>Premium Analytics & Reporting</li>
                            <li>Dedicated Priority Support</li>
                            <li>Unlimited Users</li>
                            <li>Custom Data Integrations</li>
                        </ul>
                        <p class="text-3xl font-extrabold text-indigo-600 mb-6 price-display" data-original-price="499.00" data-currency-symbol="R" data-currency-code="ZAR">R 499.00 <span class="text-slate-500 text-base font-normal">/ month</span></p>
                    </div>
                    <button class="buy-now-button featured-button w-full bg-indigo-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-300 ease-in-out transform hover:scale-105"
                            data-product-name="Business Package"
                            data-amount="499.00"
                            data-billing-cycle="MONTHLY"
                            data-plan-key="Business Package_MONTHLY"
                            onclick="initiatePayPalSubscription(event)">
                        Subscribe Now (Monthly)
                    </button>
                </div>

                <!-- Product 3: Enterprise Package -->
                <div class="bg-slate-50 p-6 rounded-xl shadow-md border border-slate-200 text-left flex flex-col justify-between">
                    <div>
                        <h3 class="text-2xl font-bold text-slate-800 mb-2">Enterprise Package</h3>
                        <p class="text-slate-600 mb-4">Full-scale solutions for large organizations and custom needs.</p>
                        <ul class="list-disc list-inside text-slate-700 text-sm space-y-1 mb-6">
                            <li>All Business Package Features</li>
                            <li>Dedicated Account Manager</li>
                            <li>24/7 Phone Support</li>
                            <li>Enhanced Custom Integrations</li>
                            <li>On-site Training & Setup</li>
                        </ul>
                        <p class="text-3xl font-extrabold text-indigo-600 mb-6 price-display" data-original-price="1200.00" data-currency-symbol="R" data-currency-code="ZAR">R 1200.00 <span class="text-slate-500 text-base font-normal">/ month</span></p>
                    </div>
                    <button class="buy-now-button featured-button w-full bg-indigo-600 text-white font-semibold py-3 px-6 rounded-xl shadow-lg transition duration-300 ease-in-out transform hover:scale-105"
                            data-product-name="Enterprise Package"
                            data-amount="1200.00"
                            data-billing-cycle="MONTHLY"
                            data-plan-key="Enterprise Package_MONTHLY"
                            onclick="initiatePayPalSubscription(event)">
                        Subscribe Now (Monthly)
                    </button>
                </div>
            </div>
        </div>

        <!-- FAA.ZONE Footer -->
        <div class="mt-8 pt-6 border-t border-slate-200">
            <div class="text-xs text-slate-400">
                <p>&copy; 2025 FAA.ZONE‚Ñ¢</p>
                <p>Interactive SPA v1.0</p>
            </div>
        </div>
    </div>

    <!-- PayPal SDK Script -->
    <script src="https://www.paypal.com/sdk/js?client-id=BAAThS_oBJJ22PM5R1nVJ...&currency=ZAR&vault=true&intent=subscription"></script>

    <script type="module">
        // IMPORTANT: Replace this placeholder with your actual LIVE PayPal Product ID.
        // This is the ID you get after successfully calling the /api/paypal?action=create-product endpoint using your LIVE credentials.
        const YOUR_PAYPAL_PRODUCT_ID = 'YOUR_STATIC_PAYPAL_PRODUCT_ID_HERE'; // <--- !!! REPLACE THIS WITH YOUR LIVE PRODUCT ID !!! --->

        // IMPORTANT: You MUST replace these placeholders with the actual LIVE PayPal Plan IDs
        // obtained after using the "Deploy Plan" button for these products in your admin portal,
        // after switching your backend to LIVE credentials.
        // The plan keys are 'Product Name_BILLING_CYCLE' (e.g., "Starter Package_MONTHLY").
        const PAYPAL_PLAN_IDS = {
            "Starter Package_MONTHLY": "P-YOUR_STARTER_MONTHLY_LIVE_PLAN_ID",   // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Starter Package_ANNUAL": "P-YOUR_STARTER_ANNUAL_LIVE_PLAN_ID",     // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Business Package_MONTHLY": "P-YOUR_BUSINESS_MONTHLY_LIVE_PLAN_ID", // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Business Package_ANNUAL": "P-YOUR_BUSINESS_ANNUAL_LIVE_PLAN_ID",   // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Enterprise Package_MONTHLY": "P-YOUR_ENTERPRISE_MONTHLY_LIVE_PLAN_ID", // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Enterprise Package_ANNUAL": "P-YOUR_ENTERPRISE_ANNUAL_LIVE_PLAN_ID"  // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
        };

        // Current logged-in user ID. Replace 'CURRENT_LOGGED_IN_USER_ID' with dynamic user ID from your auth system.
        const CURRENT_USER_ID = 'CURRENT_LOGGED_IN_USER_ID'; // <--- !!! REPLACE THIS !!! --->

        document.addEventListener('DOMContentLoaded', () => {
            // --- Currency Converter Logic (INTEGRATED) ---
            const currencySelect = document.getElementById('currency-select');
            const priceDisplays = document.querySelectorAll('.price-display');
            let exchangeRates = {}; // Store fetched exchange rates

            const API_KEY = "40015d117bc7fff9495dcf28"; // Your provided API key
            const BASE_CURRENCY = 'ZAR'; // Set to ZAR based on the updated data-original-price values

            async function fetchExchangeRates() {
                if (API_KEY === "") {
                    console.warn("Currency converter: API_KEY is missing. Please get your API key from https://www.exchangerate-api.com/ and replace 'API_KEY' in the code. Currency conversion will not work without it.");
                    alert('Currency converter API key is missing. Please set it up for currency conversion to work.');
                    currencySelect.disabled = true; // Disable dropdown if API key is missing
                    return;
                }

                try {
                    const response = await fetch(`https://v6.exchangerate-api.com/v6/${API_KEY}/latest/${BASE_CURRENCY}`);
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`HTTP error! Status: ${response.status}. API Error: ${errorData['error-type'] || 'Unknown error.'}`);
                    }
                    const data = await response.json();
                    if (data && data.conversion_rates) {
                        exchangeRates = data.conversion_rates;
                        console.log('Exchange rates fetched:', exchangeRates);
                        updatePrices(); // Update prices once rates are fetched
                    } else {
                        console.error('Failed to fetch conversion rates: Unexpected API response structure.', data);
                        alert('Could not fetch exchange rates due to unexpected API response. Check console for details.');
                        currencySelect.disabled = true;
                    }
                } catch (error) {
                    console.error('Error fetching exchange rates:', error.message || error);
                    alert('Could not fetch exchange rates. Please check your API key, network connection, and API usage limits.');
                    currencySelect.disabled = true; // Disable dropdown if fetch fails
                }
            }

            function getCurrencySymbol(currencyCode) {
                switch (currencyCode) {
                    case 'USD': return '$';
                    case 'EUR': return '‚Ç¨';
                    case 'GBP': return '¬£';
                    case 'ZAR': return 'R';
                    default: return currencyCode;
                }
            }

            function updatePrices() {
                const selectedCurrency = currencySelect.value;
                const selectedSymbol = getCurrencySymbol(selectedCurrency);

                priceDisplays.forEach(priceSpan => {
                    const originalPriceValue = parseFloat(priceSpan.dataset.originalPrice);
                    let convertedPrice = originalPriceValue;

                    if (selectedCurrency !== BASE_CURRENCY && exchangeRates[selectedCurrency]) {
                        convertedPrice = originalPriceValue * exchangeRates[selectedCurrency];
                    }
                    priceSpan.innerHTML = `${selectedSymbol}${convertedPrice.toFixed(2)} <span class="text-slate-500 text-base font-normal">/ month</span>`;
                    priceSpan.dataset.currencyCode = selectedCurrency; // Update the data-currency-code
                });
            }

            currencySelect.addEventListener('change', updatePrices);

            // Fetch rates on page load
            fetchExchangeRates();

            // --- PayPal Subscription Initiation ---
            async function initiatePayPalSubscription(event) {
                const button = event.currentTarget; // The clicked button
                button.disabled = true; // Disable button to prevent multiple clicks
                const originalButtonText = button.textContent;
                button.textContent = 'Processing...';

                const productName = button.dataset.productName;
                const billingCycle = button.dataset.billingCycle;
                const planKey = button.dataset.planKey; // e.g., "Starter Package_MONTHLY"
                const planId = PAYPAL_PLAN_IDS[planKey];

                if (!planId || planId.includes('YOUR_')) {
                    alert(`Subscription plan ID not configured for ${productName} (${billingCycle}). Please update PAYPAL_PLAN_IDS in the script with LIVE Plan IDs.`);
                    console.error(`Missing or placeholder PayPal Plan ID for ${planKey}`);
                    button.disabled = false;
                    button.textContent = originalButtonText;
                    return;
                }

                // Get the currently selected currency from the converter
                const selectedCurrency = currencySelect.value; // This is the currency the user sees and expects to pay in
                // IMPORTANT: Ensure your backend create-plan uses the same currency for the plans you deploy.
                // The PayPal SDK currency param must match the plan currency.
                // For this template, we assume ZAR plans.

                try {
                    // Call your backend to create the PayPal subscription
                    const response = await fetch(`/api/paypal?action=create-subscription`, { // This call will now use LIVE backend credentials
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            planId: planId,
                            userId: CURRENT_USER_ID, // Ensure this is your actual logged-in user ID
                            productName: productName,
                            billingCycle: billingCycle,
                            currencyCode: selectedCurrency, // Pass the currently selected currency
                            // The 'amount' is typically not passed for fixed-price plans,
                            // as PayPal uses the plan's defined price. However, good for logging/backend validation.
                            amount: parseFloat(button.dataset.amount) // The original ZAR amount from HTML dataset
                        }),
                    });

                    const result = await response.json();

                    if (!response.ok) {
                        console.error('Backend create-subscription error:', result);
                        throw new Error(result.error || 'Failed to create PayPal subscription on backend');
                    }

                    // Redirect the user to PayPal's approval URL
                    if (result.approveUrl) {
                        window.location.href = result.approveUrl;
                    } else {
                        throw new Error('No approval URL received from PayPal.');
                    }

                } catch (error) {
                    console.error('Error initiating PayPal subscription:', error);
                    alert(`An error occurred: ${error.message}. Please try again.`);
                    button.disabled = false;
                    button.textContent = originalButtonText;
                }
            }

            // Attach click event listeners to all "buy-now-button" elements
            document.querySelectorAll('.buy-now-button').forEach(button => {
                button.addEventListener('click', initiatePayPalSubscription);
            });
        });

        // Function to copy code to clipboard (global for all copy buttons)
        function copyCode(elementId, buttonElement) {
            const codeElement = document.getElementById(elementId);
            let textToCopy = '';

            if (codeElement.tagName === 'PRE' || codeElement.tagName === 'CODE') {
                textToCopy = codeElement.textContent.trim();
            } else {
                const preOrCode = codeElement.querySelector('pre') || codeElement.querySelector('code');
                if (preOrCode) {
                    textToCopy = preOrCode.textContent.trim();
                } else {
                    textToCopy = codeElement.textContent.trim();
                }
            }
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(textToCopy).then(() => {
                    buttonElement.textContent = 'Copied!';
                    buttonElement.classList.add('active');
                    setTimeout(() => {
                        buttonElement.textContent = 'Copy';
                        buttonElement.classList.remove('active');
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy text using Clipboard API: ', err);
                    fallbackCopyTextToClipboard(textToCopy, buttonElement);
                });
            } else {
                fallbackCopyTextToClipboard(textToCopy, buttonElement);
            }
        }

        function fallbackCopyTextToClipboard(textToCopy, buttonElement) {
            const textArea = document.createElement("textarea");
            textArea.value = textToCopy;
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    buttonElement.textContent = 'Copied!';
                    buttonElement.classList.add('active');
                    setTimeout(() => {
                        buttonElement.textContent = 'Copy';
                        buttonElement.classList.remove('active');
                    }, 2000);
                } else {
                    console.error('Fallback: Copying text command was unsuccessful.');
                    buttonElement.textContent = 'Failed!';
                    buttonElement.classList.add('active');
                    setTimeout(() => {
                        buttonElement.textContent = 'Copy';
                        buttonElement.classList.remove('active');
                    }, 2000);
                }
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
                buttonElement.textContent = 'Failed!';
                buttonElement.classList.add('active');
                setTimeout(() => {
                    buttonElement.textContent = 'Copy';
                    buttonElement.classList.remove('active');
                }, 2000);
            }
            document.body.removeChild(textArea);
        }
    </script>

    </script>
    
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - FAA.ZONE‚Ñ¢</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); /* Deep space gradient */
            color: #E0E0E0; /* Light gray for general text */
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 1rem; /* Added padding to give space around the central box */
        }

        /* Container for the whole content, similar to admin's panel card */
        .main-container-card {
            background-color: rgba(25, 25, 40, 0.9);
            border-radius: 1.5rem; /* More rounded */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6); /* Deeper shadow */
            max-width: 80rem; /* Increased max-width */
            width: 100%;
            text-align: center;
            border: 1px solid rgba(70, 70, 90, 0.5);
            padding: 2.5rem; /* Consistent padding */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 80vh; /* Ensure it takes a good portion of viewport height */
        }
        
        /* Header styling from admin portal */
        .page-header {
            background-color: rgba(30, 30, 45, 0.9); /* Slightly transparent dark header */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4); /* Deeper shadow */
            backdrop-filter: blur(5px); /* Subtle blur effect */
            border-bottom: 1px solid rgba(70, 70, 90, 0.5); /* Subtle bottom border */
            padding: 1.5rem 2.5rem;
            margin-bottom: 2.5rem; /* space below header */
            border-radius: 1rem;
        }
        .page-header a {
            transition: all 0.3s ease-in-out;
            color: #C0C0C0; /* Lighter gray for links */
            padding: 0.6rem 1rem;
            border-radius: 0.5rem; /* More rounded */
            font-weight: 500;
        }
        .page-header a:hover {
            background-color: rgba(60, 60, 90, 0.7); /* Darker hover background */
            color: #93C5FD; /* Light blue accent on hover */
            transform: translateY(-2px); /* Subtle lift effect */
        }
        .page-header a.text-2xl { /* Logo specific styling */
            color: #A78BFA; /* Purple accent for logo */
            font-weight: 800;
        }

        /* Footer styling from admin portal */
        .page-footer {
            background-color: rgba(20, 20, 35, 0.9);
            border-top: 1px solid rgba(70, 70, 90, 0.5);
            color: #A0A0A0; /* Slightly darker gray for footer text */
            padding: 2rem;
            margin-top: 2.5rem; /* space above footer */
            border-radius: 1rem;
        }
        .page-footer-logo {
            color: #A78BFA;
            font-weight: 800;
        }
        .page-footer a {
            color: #C0C0C0;
            transition: color 0.3s ease;
        }
        .page-footer a:hover {
            color: #93C5FD;
        }

        /* Product Card Styling (adapted for dark theme) - mostly from admin portal's product-card */
        .product-card {
            background-color: rgba(25, 25, 40, 0.9); /* Dark card background */
            border-radius: 1rem; /* More rounded */
            border: 1px solid rgba(70, 70, 90, 0.5); /* Subtle border */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5); /* Deeper, softer shadow */
            transition: all 0.4s ease-in-out;
            padding: 2rem; /* Consistent with dashboard p-8 for cards */
            display: flex;
            flex-direction: column;
            text-align: left; /* Ensure text aligns left */
            height: 500px; /* Consistent height */
            justify-content: space-between; /* Pushes buttons to bottom */
            position: relative;
            z-index: 2;
        }
        .product-card:hover {
            transform: translateY(-8px) scale(1.01); /* More distinct lift and scale */
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7); /* Even deeper shadow on hover */
            border-color: #A78BFA; /* Purple border on hover */
        }
        .product-card.featured {
            border-color: #A78BFA; /* Purple for featured border */
            box-shadow: 0 15px 40px rgba(167, 139, 250, 0.4); /* Featured glow */
        }
        .product-card h3 {
            color: #A78BFA; /* Purple for card titles */
        }
        .product-card p {
            color: #B0B0B0; /* Lighter gray for descriptive text */
        }
        .price-display {
            color: #93C5FD; /* Light blue for prices */
        }
        .feature-list {
            list-style: none;
            padding: 0;
            margin: 0;
            text-align: left;
            width: 100%;
            margin-bottom: 1.5rem;
            flex-grow: 1; /* Allows list to take available space */
        }
        .feature-list li {
            margin-bottom: 0.6rem;
            display: flex;
            align-items: flex-start;
            color: #C0C0C0;
            font-size: 0.95rem;
        }
        .feature-list li svg { /* Adding checkmark icon for features */
            margin-right: 0.75rem;
            color: #34D399; /* Green accent for checkmarks */
            flex-shrink: 0;
            width: 24px;
            height: 24px;
        }

        /* Call-to-action Button (cta-button) - from admin portal */
        .cta-button {
            background: linear-gradient(45deg, #6B46C1, #8B5CF6); /* Purple gradient */
            color: white;
            padding: 0.85rem 1.8rem; /* Slightly larger padding */
            border-radius: 0.75rem; /* More rounded */
            font-weight: 700; /* Bolder */
            transition: all 0.4s ease;
            box-shadow: 0 6px 15px rgba(139, 92, 246, 0.4); /* Glow effect */
            position: relative;
            overflow: hidden;
            border: none;
            letter-spacing: 0.05em; /* Slightly spaced out text */
            min-width: 150px; /* Ensure consistent button width */
            text-align: center;
        }
        .cta-button:hover {
            background: linear-gradient(45deg, #7C5BC7, #9B6EF9); /* Slightly lighter gradient on hover */
            transform: translateY(-3px) scale(1.02); /* More pronounced lift and slight scale */
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.6); /* Enhanced glow */
        }
        .cta-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0%;
            height: 0%;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transition: all 0.7s ease-out;
            transform: translate(-50%, -50%);
            opacity: 0;
        }
        .cta-button:hover::before {
            width: 300%;
            height: 300%;
            opacity: 1;
        }
        /* Currency Selector style */
        .currency-selector-container {
            background-color: rgba(45, 45, 70, 0.8);
            border: 1px solid rgba(80, 80, 100, 0.6);
            color: #D0D0D0;
            border-radius: 0.75rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        .currency-selector-container label {
            color: #D0D0D0;
        }
        #currency-select {
            background-color: rgba(60, 60, 90, 0.9);
            border: 1px solid rgba(100, 100, 120, 0.7);
            color: #E0E0E0;
        }
        #currency-select option {
            background-color: rgba(60, 60, 90, 0.9);
            color: #E0E0E0;
        }

        /* Toggle switch for monthly/annual - from admin portal */
        .toggle-switch {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: space-between;
            width: 180px;
            height: 34px;
            margin: 10px 0;
            border-radius: 17px;
            background-color: rgba(70, 70, 90, 0.8);
            cursor: pointer;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.3), 0 1px 0 rgba(255,255,255,0.05);
            padding: 0 8px;
            margin-bottom: 1.5rem; /* Added margin to separate from price */
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: transparent;
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 17px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.85rem;
            font-weight: 600;
            color: #C0C0C0;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 85px;
            left: 4px;
            bottom: 4px;
            background: linear-gradient(45deg, #60A5FA, #93C5FD);
            -webkit-transition: .4s;
            transition: .4s;
            border-radius: 13px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        input:checked + .slider {
            background-color: transparent;
        }
        input:focus + .slider {
            box-shadow: 0 0 1px #93C5FD;
        }
        input:checked + .slider:before {
            -webkit-transform: translateX(88px);
            -ms-transform: translateX(88px);
            transform: translateX(88px);
        }
        .slider span {
            z-index: 1;
            user-select: none;
            color: #C0C0C0;
            transition: color 0.3s ease;
            flex-shrink: 0;
        }
        /* Color logic for toggle text based on checked state (Monthly active when unchecked) */
        .slider .monthly-text {
            margin-right: 5px; /* Adjust spacing between text labels */
        }
        .slider .annual-text {
            margin-left: 5px; /* Adjust spacing between text labels */
        }
        input:checked + .slider .monthly-text {
            color: #C0C0C0;
        }
        input:checked + .slider .annual-text {
            color: white;
        }
        input:not(:checked) + .slider .monthly-text {
            color: white;
        }
        input:not(:checked) + .slider .annual-text {
            color: #C0C0C0;
        }

        /* PayPal Error/Success Message Display */
        .paypal-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1000;
            font-size: 0.9rem;
            max-width: 300px;
            text-align: center;
            animation: fadeInOut 5s forwards;
        }
        .paypal-error-message {
            background-color: #ffdddd;
            color: #d8000c;
        }
        .paypal-success-message {
            background-color: #d4edda;
            color: #155724;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(-20px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">
    <!-- Header from Admin Portal -->
    <header class="page-header w-full">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center space-y-2 md:space-y-0">
            <a href="index.html" class="text-2xl font-bold">ü¶ç FAA.ZONE‚Ñ¢</a>
            <nav class="flex flex-wrap justify-center md:justify-end items-center space-x-4 md:space-x-6 text-sm">
                <a href="/">Home</a>
                <a href="/pricing">Pricing & Plans üí∞</a>
                <a href="/products">Products</a>
                <a href="/about">About Us ‚ÑπÔ∏è</a>
                <a href="/contact">Contact Us üìß</a>
            </nav>
        </div>
    </header>

    <div class="main-container-card">
        <div>
            <h2 class="text-4xl font-extrabold text-blue-400 mb-4 tracking-tight">
                Explore Our <span class="text-purple-400">Products</span>
            </h2>
            <p class="text-lg text-gray-400 mb-8 leading-relaxed">
                Choose the package that best fits your needs and proceed to a secure checkout.
            </p>

            <!-- Currency Selector -->
            <div class="mt-8 mb-10 p-6 rounded-xl shadow-md border text-left flex items-center justify-between mx-auto max-w-xs currency-selector-container">
                <label for="currency-select" class="font-medium">Display prices in:</label>
                <select id="currency-select" class="ml-4 p-2 border rounded-md text-sm">
                    <option value="ZAR">ZAR (R)</option>
                    <option value="USD">USD ($)</option>
                    <option value="EUR">EUR (‚Ç¨)</option>
                    <option value="GBP">GBP (¬£)</option>
                </select>
            </div>

            <!-- Product Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-8">
                <!-- Product 1: Starter Package -->
                <div class="product-card">
                    <div>
                        <h3 class="text-2xl font-bold mb-2">Starter Package</h3>
                        <p class="mb-4">Ideal for individuals and small teams beginning their digital journey.</p>

                        <!-- Toggle Switch for Monthly/Annual -->
                        <label class="toggle-switch">
                            <input type="checkbox" onchange="toggleSubscriptionType(this.closest('.product-card'), this.checked)">
                            <span class="slider">
                                <span class="monthly-text">Monthly (15% off)</span>
                                <span class="annual-text">Annual</span>
                            </span>
                        </label>

                        <p class="text-5xl font-extrabold price-display"
                           data-original-monthly-price="199.00"
                           data-original-annual-price="199.00" <!-- This will be updated by JS -->
                           data-currency-symbol="R"
                           data-currency-code="ZAR">R 199.00 <span class="text-gray-400 text-xl font-normal">/ month</span></p>
                        <ul class="feature-list mt-6">
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Basic API Access</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Standard Analytics Dashboard</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Community Support</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Up to 5 Users</li>
                        </ul>
                    </div>
                    <button class="buy-now-button cta-button w-full"
                            data-item-name="Starter Package"
                            data-amount="199.00"
                            data-item-description="Monthly subscription for Starter Package."
                            data-billing-cycle="MONTHLY"
                            data-plan-key="Starter Package_MONTHLY"
                            onclick="initiatePayPalSubscription(event)">
                        Subscribe Now
                    </button>
                </div>

                <!-- Product 2: Business Package -->
                <div class="product-card featured">
                    <div>
                        <h3 class="text-2xl font-bold mb-2">Business Package</h3>
                        <p class="mb-4">Comprehensive tools for growing businesses and advanced operations.</p>

                        <!-- Toggle Switch for Monthly/Annual -->
                        <label class="toggle-switch">
                            <input type="checkbox" onchange="toggleSubscriptionType(this.closest('.product-card'), this.checked)">
                            <span class="slider">
                                <span class="monthly-text">Monthly (15% off)</span>
                                <span class="annual-text">Annual</span>
                            </span>
                        </label>

                        <p class="text-5xl font-extrabold price-display"
                           data-original-monthly-price="499.00"
                           data-original-annual-price="499.00" <!-- This will be updated by JS -->
                           data-currency-symbol="R"
                           data-currency-code="ZAR">R 499.00 <span class="text-gray-400 text-xl font-normal">/ month</span></p>
                        <ul class="feature-list mt-6">
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Advanced API Access</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Premium Analytics & Reporting</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Dedicated Priority Support</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Unlimited Users</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Custom Data Integrations</li>
                        </ul>
                    </div>
                    <button class="buy-now-button cta-button w-full"
                            data-item-name="Business Package"
                            data-amount="499.00"
                            data-item-description="Monthly subscription for Business Package."
                            data-billing-cycle="MONTHLY"
                            data-plan-key="Business Package_MONTHLY"
                            onclick="initiatePayPalSubscription(event)">
                        Subscribe Now
                    </button>
                </div>

                <!-- Product 3: Enterprise Package -->
                <div class="product-card">
                    <div>
                        <h3 class="text-2xl font-bold mb-2">Enterprise Package</h3>
                        <p class="mb-4">Full-scale solutions for large organizations and custom needs.</p>

                        <!-- Toggle Switch for Monthly/Annual -->
                        <label class="toggle-switch">
                            <input type="checkbox" onchange="toggleSubscriptionType(this.closest('.product-card'), this.checked)">
                            <span class="slider">
                                <span class="monthly-text">Monthly (15% off)</span>
                                <span class="annual-text">Annual</span>
                            </span>
                        </label>

                        <p class="text-5xl font-extrabold price-display"
                           data-original-monthly-price="1200.00"
                           data-original-annual-price="1200.00" <!-- This will be updated by JS -->
                           data-currency-symbol="R"
                           data-currency-code="ZAR">R 1200.00 <span class="text-gray-400 text-xl font-normal">/ month</span></p>
                        <ul class="feature-list mt-6">
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>All Business Package Features</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Dedicated Account Manager</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>24/7 Phone Support</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>Enhanced Custom Integrations</li>
                            <li><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>On-site Training & Setup</li>
                        </ul>
                    </div>
                    <button class="buy-now-button cta-button w-full"
                            data-item-name="Enterprise Package"
                            data-amount="1200.00"
                            data-item-description="Monthly subscription for Enterprise Package."
                            data-billing-cycle="MONTHLY"
                            data-plan-key="Enterprise Package_MONTHLY"
                            onclick="initiatePayPalSubscription(event)">
                        Subscribe Now
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer from Admin Portal -->
    <footer class="page-footer w-full mt-12">
        <div class="container mx-auto px-6">
            <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0">
                <div class="text-lg page-footer-logo">FAA.ZONE‚Ñ¢</div>
                <p class="text-sm">ScrollGrid ¬∑ PulseTrade Certified ¬∑ TreatyMesh Validated</p>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">Privacy</a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">Terms</a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors">Contact</a>
                </div>
            </div>
            <p class="text-xs mt-6">¬© 2025 Fruitful Holdings (Pty) Ltd. All rights reserved.</p>
        </div>
    </footer>

    <!-- PayPal SDK Script -->
    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_LIVE_CLIENT_ID&currency=ZAR&vault=true&intent=subscription"></script>

    <script type="module">
        // IMPORTANT: Replace this placeholder with your actual LIVE PayPal Client ID.
        const YOUR_PAYPAL_LIVE_CLIENT_ID = 'YOUR_PAYPAL_LIVE_CLIENT_ID'; // <--- !!! REPLACE THIS WITH YOUR LIVE CLIENT ID !!! --->

        // IMPORTANT: You MUST replace these placeholders with the actual LIVE PayPal Plan IDs
        // obtained after using the "Deploy Plan" button for these products in your admin portal,
        // after switching your backend to LIVE credentials.
        // The plan keys are 'Product Name_BILLING_CYCLE' (e.g., "Starter Package_MONTHLY").
        const PAYPAL_PLAN_IDS = {
            "Starter Package_MONTHLY": "P-YOUR_STARTER_MONTHLY_LIVE_PLAN_ID",    // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Starter Package_ANNUAL": "P-YOUR_STARTER_ANNUAL_LIVE_PLAN_ID",      // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Business Package_MONTHLY": "P-YOUR_BUSINESS_MONTHLY_LIVE_PLAN_ID", // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Business Package_ANNUAL": "P-YOUR_BUSINESS_ANNUAL_LIVE_PLAN_ID",    // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Enterprise Package_MONTHLY": "P-YOUR_ENTERPRISE_MONTHLY_LIVE_PLAN_ID", // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
            "Enterprise Package_ANNUAL": "P-YOUR_ENTERPRISE_ANNUAL_LIVE_PLAN_ID"  // <--- !!! REPLACE WITH ACTUAL LIVE ID !!! --->
        };

        // Current logged-in user ID. Replace 'CURRENT_LOGGED_IN_USER_ID' with dynamic user ID from your auth system.
        const CURRENT_USER_ID = 'CURRENT_LOGGED_IN_USER_ID'; // <--- !!! REPLACE THIS !!! --->

        document.addEventListener('DOMContentLoaded', () => {
            // --- Currency Converter Logic (INTEGRATED) ---
            const currencySelect = document.getElementById('currency-select');
            const priceDisplays = document.querySelectorAll('.price-display');
            let exchangeRates = {}; // Store fetched exchange rates

            const API_KEY = "40015d117bc7fff9495dcf28"; // Your provided API key
            const BASE_CURRENCY = 'ZAR'; // Set to ZAR based on the updated data-original-price values

            function showTemporaryMessage(message, type = 'error') {
                const messageDiv = document.createElement('div');
                messageDiv.className = `paypal-message ${type === 'success' ? 'paypal-success-message' : 'paypal-error-message'}`;
                messageDiv.textContent = message;
                document.body.appendChild(messageDiv);
                setTimeout(() => messageDiv.remove(), 5000); // Remove after 5 seconds
            }

            async function fetchExchangeRates() {
                if (API_KEY === "") {
                    showTemporaryMessage('Currency converter API key is missing. Please set it up for currency conversion to work.', 'error');
                    currencySelect.disabled = true; // Disable dropdown if API key is missing
                    console.warn("Currency converter: API_KEY is missing. Please get your API key from https://www.exchangerate-api.com/ and replace 'API_KEY' in the code. Currency conversion will not work without it.");
                    return;
                }

                try {
                    const response = await fetch(`https://v6.exchangerate-api.com/v6/${API_KEY}/latest/${BASE_CURRENCY}`);
                    if (!response.ok) {
                        const errorData = await response.json();
                        const errorMessage = `Could not fetch exchange rates: ${errorData['error-type'] || 'Unknown error.'}`;
                        showTemporaryMessage(errorMessage, 'error');
                        throw new Error(`HTTP error! Status: ${response.status}. API Error: ${errorData['error-type'] || 'Unknown error.'}`);
                    }
                    const data = await response.json();
                    if (data && data.conversion_rates) {
                        exchangeRates = data.conversion_rates;
                        console.log('Exchange rates fetched:', exchangeRates);
                        updatePrices(); // Update prices once rates are fetched
                    } else {
                        showTemporaryMessage('Could not fetch exchange rates due to unexpected API response. Check console for details.', 'error');
                        console.error('Failed to fetch conversion rates: Unexpected API response structure.', data);
                        currencySelect.disabled = true;
                    }
                } catch (error) {
                    showTemporaryMessage(`Error fetching exchange rates: ${error.message}. Please check your API key, network connection, and API usage limits.`, 'error');
                    console.error('Error fetching exchange rates:', error.message || error);
                    currencySelect.disabled = true; // Disable dropdown if fetch fails
                }
            }

            function getCurrencySymbol(currencyCode) {
                switch (currencyCode) {
                    case 'USD': return '$';
                    case 'EUR': return '‚Ç¨';
                    case 'GBP': return '¬£';
                    case 'ZAR': return 'R';
                    default: return currencyCode;
                }
            }

            // Function to toggle between monthly and annual prices for products.html
            function toggleSubscriptionType(cardElement, isAnnualChecked) {
                const priceSpan = cardElement.querySelector('.price-display');
                const originalMonthlyPrice = parseFloat(priceSpan.dataset.originalMonthlyPrice);
                const originalAnnualPrice = (originalMonthlyPrice * 12 * (1 - 0.15)); // Calculate annual price with 15% discount
                
                let newPrice;
                let newBillingCycle;
                let suffix;

                if (isAnnualChecked) { // Checkbox is checked, means Annual is selected
                    newPrice = originalAnnualPrice;
                    newBillingCycle = "ANNUAL";
                    suffix = "/ year";
                } else { // Checkbox is unchecked, means Monthly is selected
                    newPrice = originalMonthlyPrice;
                    newBillingCycle = "MONTHLY";
                    suffix = "/ month";
                }

                // Apply currency conversion
                const selectedCurrency = currencySelect.value;
                let convertedPrice = newPrice;
                if (selectedCurrency !== BASE_CURRENCY && exchangeRates[selectedCurrency]) {
                    convertedPrice = newPrice * exchangeRates[selectedCurrency];
                }
                
                priceSpan.innerHTML = `${getCurrencySymbol(selectedCurrency)}${convertedPrice.toFixed(2)} <span class="text-gray-400 text-xl font-normal">${suffix}</span>`;

                // Update the PayPal button's data attributes
                const buyButton = cardElement.querySelector('.buy-now-button');
                buyButton.dataset.amount = newPrice.toFixed(2); // Always update with the ZAR base amount
                buyButton.dataset.billingCycle = newBillingCycle;
                buyButton.dataset.planKey = `${buyButton.dataset.itemName.replace(/\s/g, '_')}_${newBillingCycle}`;
            }

            function updatePrices() {
                const selectedCurrency = currencySelect.value;
                const selectedSymbol = getCurrencySymbol(selectedCurrency);

                priceDisplays.forEach(priceSpan => {
                    const cardElement = priceSpan.closest('.product-card');
                    const toggleCheckbox = cardElement.querySelector('.toggle-switch input[type="checkbox"]');
                    const isAnnualDisplayed = toggleCheckbox ? toggleCheckbox.checked : false;

                    const originalMonthlyPrice = parseFloat(priceSpan.dataset.originalMonthlyPrice);
                    const originalAnnualPrice = (originalMonthlyPrice * 12 * (1 - 0.15));

                    let originalPriceValue = isAnnualDisplayed ? originalAnnualPrice : originalMonthlyPrice;
                    
                    let convertedPrice = originalPriceValue;

                    if (selectedCurrency !== BASE_CURRENCY && exchangeRates[selectedCurrency]) {
                        convertedPrice = originalPriceValue * exchangeRates[selectedCurrency];
                    }
                    const suffix = isAnnualDisplayed ? '/ year' : '/ month';
                    priceSpan.innerHTML = `${selectedSymbol}${convertedPrice.toFixed(2)} <span class="text-gray-400 text-xl font-normal">${suffix}</span>`;
                    priceSpan.dataset.currencyCode = selectedCurrency;
                });
            }

            currencySelect.addEventListener('change', updatePrices);

            // Fetch rates on page load
            fetchExchangeRates();

            // --- PayPal Subscription Initiation ---
            async function initiatePayPalSubscription(event) {
                const button = event.currentTarget; // The clicked button
                button.disabled = true; // Disable button to prevent multiple clicks
                const originalButtonText = button.textContent;
                button.textContent = 'Processing...';

                const productName = button.dataset.itemName;
                const billingCycle = button.dataset.billingCycle;
                const planKey = button.dataset.planKey; // e.g., "Starter Package_MONTHLY"
                const planId = PAYPAL_PLAN_IDS[planKey];

                if (!planId || planId.includes('YOUR_')) {
                    showTemporaryMessage(`Subscription plan ID not configured for ${productName} (${billingCycle}). Please update PAYPAL_PLAN_IDS in the script with LIVE Plan IDs.`, 'error');
                    console.error(`Missing or placeholder PayPal Plan ID for ${planKey}`);
                    button.disabled = false;
                    button.textContent = originalButtonText;
                    return;
                }

                // Get the currently selected currency from the converter
                const selectedCurrency = currencySelect.value; // This is the currency the user sees and expects to pay in
                // IMPORTANT: Ensure your backend create-plan uses the same currency for the plans you deploy.
                // The PayPal SDK currency param must match the plan currency.
                // For this template, we assume ZAR plans.

                try {
                    // Call your backend to create the PayPal subscription
                    const response = await fetch(`/api/paypal?action=create-subscription`, { // This call will now use LIVE backend credentials
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            planId: planId,
                            userId: CURRENT_USER_ID, // Ensure this is your actual logged-in user ID
                            productName: productName,
                            billingCycle: billingCycle,
                            currencyCode: selectedCurrency, // Pass the currently selected currency
                            // The 'amount' is typically not passed for fixed-price plans,
                            // as PayPal uses the plan's defined price. However, good for logging/backend validation.
                            amount: parseFloat(button.dataset.amount) // The original ZAR amount from HTML dataset
                        }),
                    });

                    const result = await response.json();

                    if (!response.ok) {
                        showTemporaryMessage(`Failed to create subscription: ${result.error || 'Unknown error'}. Check console.`, 'error');
                        console.error('Backend create-subscription error:', result);
                        throw new Error(result.error || 'Failed to create PayPal subscription on backend');
                    }

                    // Redirect the user to PayPal's approval URL
                    if (result.approveUrl) {
                        window.location.href = result.approveUrl;
                    } else {
                        showTemporaryMessage('No approval URL received from PayPal.', 'error');
                        throw new Error('No approval URL received from PayPal.');
                    }

                } catch (error) {
                    showTemporaryMessage(`An error occurred: ${error.message}. Please try again.`, 'error');
                    console.error('Error initiating PayPal subscription:', error);
                    button.disabled = false;
                    button.textContent = originalButtonText;
                }
            }

            // Attach click event listeners to all "buy-now-button" elements
            document.querySelectorAll('.buy-now-button').forEach(button => {
                button.addEventListener('click', initiatePayPalSubscription);
            });
        });
    </script>
</body>
</html>

    xPricing

Stellar Pricing for Every Journey
Choose the perfect plan that aligns with your cosmic goals.

Our prices
Only pay for what you needx
